import{u as J,r as o,j as e,M as _,b as D,c as h,G as d,g as q,P as K,I,T as p,F as Q,h as X,S as Y,k as Z}from"./index-Dg2GFtxE.js";import{d as $,D as ee}from"./Add-DhjQQOyT.js";import{h as T}from"./moment-G82_0lEo.js";import{d as te,c as ae}from"./AcademyCategoryApi-ASP_xB5v.js";import{T as re,a as se,b as oe,c as S,d as U,e as ie,f as de}from"./TableRow-tis0D7HP.js";import{E as le}from"./Edit-CUj485z6.js";import{D as ne}from"./DeleteForever-CR4V1Om4.js";import{D as ce,a as me}from"./DialogTitle-CHS1QA2F.js";import{M as C}from"./MenuItem-DouCongq.js";import"./LastPage-DdfZQxWB.js";const B=[{id:"topicId",label:"ID"},{id:"topicName",label:"Name",minWidth:100},{id:"description",label:"Description",minWidth:100},{id:"moduleName",label:"Module",minWidth:150},{id:"videoUrl",label:"VideoUrl"},{id:"createdBy",label:"Created By",align:"right"},{id:"updatedBy",label:"Updated By",align:"right"},{id:"insertedDate",label:"Inserted Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],De=()=>{J();const[u,x]=o.useState(0),[l,P]=o.useState(10),[g,f]=o.useState([]),[E,M]=o.useState([]),[w,n]=o.useState(!1),[W,k]=o.useState(!1),[s,j]=o.useState({topicName:"",description:"",moduleId:"",videoUrl:""}),[i,b]=o.useState({}),[v,A]=o.useState(!1),F=(t,r)=>{x(r)},R=t=>{P(+t.target.value),x(0)},N={"Content-type":"application/json",Authorization:"Bearer "+JSON.parse(sessionStorage.getItem("user")).accessToken},H=async()=>{try{const r=(await te(N)).data.content;if(console.log(r),r){const y=r.map(a=>({topicId:a.topicId,topicName:a.topicName,description:a.description,moduleName:a.academicModuleDtoList?a.academicModuleDtoList.moduleName:"No Module Name",videoUrl:a.videoUrl,insertedDate:T(a.insertedDate).format("L"),updatedDate:T(a.updatedDate).format("L"),createdBy:a.createdBy?a.createdBy.userName:"No User",updatedBy:a.updatedBy?a.updatedBy.userName:"No User"}));f(y)}else f([])}catch(t){console.error("Error fetching topics:",t)}},L=async()=>{try{const r=(await ae(N)).data.content;if(r){const a=r.sort((m,G)=>m.moduleName.localeCompare(G.moduleName)).map(m=>({moduleId:m.moduleId,moduleName:m.moduleName}));M(a)}}catch(t){console.error("Error fetching modules:",t)}};o.useEffect(()=>{H(),L()},[v]);const z=()=>{const t={};return(!s.topicName||s.topicName.trim()==="")&&(t.topicName="Enter the topic name"),(!s.description||s.description.trim()==="")&&(t.description="Enter the description"),(!s.videoUrl||s.videoUrl.trim()==="")&&(t.videoUrl="Enter the videoUrl"),s.moduleId||(t.moduleId="Select a module"),t},c=t=>{j({...s,[t.target.name]:t.target.value}),b({...i,[t.target.name]:null})},O=()=>{k(!1),j({topicName:"",description:"",moduleId:"",videoUrl:""}),n(!0)},V=()=>{const t=z();Object.keys(t).length===0?(n(!1),A(!v)):b(t)};return e.jsxs(_,{title:e.jsxs(D,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Academy Topics"}),e.jsxs(h,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:O,children:["Add",e.jsx($,{sx:{color:"#fff"}})]})]}),children:[e.jsx(d,{container:!0,spacing:q}),e.jsxs(K,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(re,{sx:{maxHeight:440},children:e.jsxs(se,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(oe,{children:e.jsx(S,{children:B.map(t=>e.jsx(U,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(ie,{children:g.slice(u*l,u*l+l).map(t=>e.jsx(S,{hover:!0,role:"checkbox",tabIndex:-1,children:B.map(r=>e.jsx(U,{align:r.align,children:r.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(I,{color:"primary",children:e.jsx(le,{})}),e.jsx(I,{color:"error",children:e.jsx(ne,{})})]}):t[r.id]||"No Data"},r.id))},t.topicId))})]})}),e.jsx(de,{rowsPerPageOptions:[10,25,100],component:"div",count:g.length,rowsPerPage:l,page:u,onPageChange:F,onRowsPerPageChange:R})]}),e.jsxs(ce,{open:w,onClose:()=>n(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(me,{sx:{fontSize:"16px"},children:W?"Edit Topic":"Add Topic"}),e.jsxs(D,{component:"form",noValidate:!0,sx:{p:3},onSubmit:t=>{t.preventDefault(),V()},children:[e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Topic Name",name:"topicName",value:s.topicName,onChange:c,error:!!i.topicName,helperText:i.topicName})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"Description",name:"description",value:s.description,onChange:c,error:!!i.description,helperText:i.description,multiline:!0,rows:3})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(Q,{fullWidth:!0,error:!!i.moduleId,children:[e.jsx(X,{id:"module-select",children:"Module"}),e.jsxs(Y,{labelId:"module-select",name:"moduleId",value:s.moduleId,onChange:c,children:[e.jsx(C,{value:"",children:e.jsx("em",{children:"None"})}),E.map(t=>e.jsx(C,{value:t.moduleId,children:t.moduleName},t.moduleId))]}),e.jsx(Z,{children:i.moduleId})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsx(p,{fullWidth:!0,label:"VideoUrl ",name:"videoUrl",value:s.videoUrl,onChange:c,error:!!i.videoUrl,helperText:i.videoUrl})})]}),e.jsxs(ee,{children:[e.jsx(h,{onClick:()=>n(!1),children:"Cancel"}),e.jsx(h,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})]})]})]})};export{De as default};
