import{a as h,B as m,u as ee,r as i,j as e,M as te,b as w,c as x,G as g,g as ae,P as re,I as E,T as y}from"./index-Dg2GFtxE.js";import{h as F}from"./moment-G82_0lEo.js";import{d as se,D as ne}from"./Add-DhjQQOyT.js";import{T as ie,a as de,b as oe,c as k,d as U,e as le,f as ce}from"./TableRow-tis0D7HP.js";import{E as me}from"./Edit-CUj485z6.js";import{D as he}from"./DeleteForever-CR4V1Om4.js";import{D as ue,a as fe}from"./DialogTitle-CHS1QA2F.js";import"./LastPage-DdfZQxWB.js";import"./MenuItem-DouCongq.js";const pe=async n=>await h({method:"get",url:`${m}/advertisement/v1/getAllAdvertisementByPagination/{pageNumber}/{pageSize}?pageNumber=0&pageSize=10`,headers:n}),ge=async(n,l)=>{try{return await h({method:"POST",url:`${m}/advertisement/v1/createAdvertisement`,headers:l,data:n}).then(function(a){console.log(a),a.data.responseCode===201?alert("Advertisement  added successfully"):a.data.responseCode===400&&alert(a.data.errorMessage)})}catch(a){alert(a)}},ve=async(n,l)=>await h({method:"delete",url:`${m}/advertisement/v1/deleteAdvertisementById/${n}`,headers:l}).then(a=>{a.data.responseCode===200?alert(a.data.message):a.data.responseCode===400&&alert(a.data.errorMessage)}).catch(a=>{console.log(a)}),xe=async(n,l)=>await h({method:"GET",url:`${m}/advertisement/v1/getAdvertisementByAdvertisementId/{advertisementId}?advertisementId=${n}`,headers:l}),ye=async(n,l)=>(console.log(n),await h({method:"PUT",url:`${m}/advertisement/v1/updateAdvertisement`,headers:l,data:n}).then(function(a){console.log(a),a.data.responseCode===201?alert(a.data.message):a.data.responseCode===400&&alert(a.data.errorMessage)}).catch(function(a){console.log(a)})),W=[{id:"advertisementId",label:"ID"},{id:"advertisementName",label:"Name",minWidth:100},{id:"description",label:"Description",minWidth:100},{id:"file",label:"File"},{id:"createdBy",label:"Created By",align:"right"},{id:"updatedBy",label:"Updated By",align:"right"},{id:"insertedDate",label:"Inserted Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],we=()=>{ee();const[n,l]=i.useState(0),[a,$]=i.useState(10),[N,j]=i.useState([]),[M,u]=i.useState(!1),[b,B]=i.useState(!1),[d,f]=i.useState({advertisementName:"",description:"",fileName:""}),[c,I]=i.useState({}),[Ne,C]=i.useState(""),[je,D]=i.useState(""),[A,R]=i.useState(null),[z,O]=i.useState(!1),[G,H]=i.useState(null),S=i.useRef(null),L=(t,r)=>{l(r)},J=t=>{$(+t.target.value),l(0)},v=JSON.parse(sessionStorage.getItem("user")),p={"Content-type":"application/json",Authorization:"Bearer "+v.accessToken},V=`${m}/file/downloadFile/?filePath=`,P=async()=>{try{const r=(await pe(p)).data.content;if(r){const s=r.map(o=>({advertisementId:o.advertisementId,advertisementName:o.advertisementName,description:o.description,file:o.filePath===null?"NO IMAGE FOUND":e.jsx("img",{src:V+o.filePath,alt:o.fileName,style:{width:100,height:50}}),insertedDate:F(o.insertedDate).format("L"),updatedDate:F(o.updatedDate).format("L"),createdBy:o.createdBy?o.createdBy.userName:"No User",updatedBy:o.updatedBy?o.updatedBy.userName:"No User"}));j(s)}else j([])}catch(t){console.error("Error fetching data:",t)}};i.useEffect(()=>{P()},[z]);const _=async t=>{t.preventDefault();const r=Q();if(Object.keys(r).length>0)I(r);else try{if(b){const s={...d,advertisementId:G,updatedBy:{userId:v.userId}};await ye(s,p)}else await ge(d,p);f({advertisementName:"",description:"",fileName:""}),S.current.value=null,O(s=>!s),u(!1)}catch(s){console.error("Error saving advertisement:",s)}},q=async t=>{if(t.preventDefault(),!A){C("Please select a file");return}const r=new FormData;r.append("file",A);try{const s=await h.post(`${m}/file/uploadFile`,r,{headers:{"content-type":"multipart/form-data",Authorization:"Bearer "+v.accessToken}});D(s.data.fileName),alert(s.data.message),f({...d,fileName:s.data.fileName}),C("")}catch(s){console.error("Error uploading file:",s)}},K=t=>{D(t.target.files[0].name),R(t.target.files[0])},Q=()=>{const t={};return(!d.advertisementName||d.advertisementName.trim()==="")&&(t.advertisementName="Enter the Advertisement name"),(!d.description||d.description.trim()==="")&&(t.description="Enter the description"),(!d.fileName||d.fileName.trim()==="")&&(t.fileName="Select the file"),t},T=t=>{f({...d,[t.target.name]:t.target.value,createdBy:{userId:v.userId}}),I({...c,[t.target.name]:null})},X=()=>{B(!1),f({advertisementName:"",description:"",fileName:""}),u(!0)},Y=async t=>{B(!0),u(!0);try{const s=(await xe(t,p)).data;H(s.advertisementId),f({advertisementName:s.advertisementName,description:s.description,fileName:s.fileName})}catch(r){console.error("Error fetching advertisement details:",r)}},Z=async t=>{try{await ve(t,p),P()}catch(r){console.error("Error deleting advertisement:",r)}};return e.jsxs(te,{title:e.jsxs(w,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Banner"}),e.jsxs(x,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:X,children:["Add",e.jsx(se,{sx:{color:"#fff"}})]})]}),children:[e.jsx(g,{container:!0,spacing:ae}),e.jsxs(re,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(ie,{sx:{maxHeight:440},children:e.jsxs(de,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(oe,{children:e.jsx(k,{children:W.map(t=>e.jsx(U,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(le,{children:N.slice(n*a,n*a+a).map(t=>e.jsx(k,{hover:!0,role:"checkbox",tabIndex:-1,children:W.map(r=>e.jsx(U,{align:r.align,children:r.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(E,{onClick:()=>Y(t.advertisementId),color:"primary",children:e.jsx(me,{})}),e.jsx(E,{onClick:()=>Z(t.advertisementId),color:"error",children:e.jsx(he,{})})]}):t[r.id]},r.id))},t.advertisementId))})]})}),e.jsx(ce,{rowsPerPageOptions:[10,25,100],component:"div",count:N.length,rowsPerPage:a,page:n,onPageChange:L,onRowsPerPageChange:J})]}),e.jsxs(ue,{open:M,onClose:()=>u(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(fe,{sx:{fontSize:"16px"},children:b?"Edit Advertisement":"Add Advertisement"}),e.jsxs(w,{component:"form",onSubmit:_,noValidate:!0,sx:{p:3},children:[e.jsxs(g,{container:!0,spacing:2,children:[e.jsx(g,{item:!0,xs:12,children:e.jsx(y,{fullWidth:!0,label:"Advertisement Name",name:"advertisementName",value:d.advertisementName,onChange:T,error:!!c.advertisementName,helperText:c.advertisementName})}),e.jsx(g,{item:!0,xs:12,children:e.jsx(y,{fullWidth:!0,label:"Description",name:"description",value:d.description,onChange:T,error:!!c.description,helperText:c.description,multiline:!0,rows:3})}),e.jsxs(g,{item:!0,xs:12,children:[e.jsx(y,{margin:"normal",fullWidth:!0,id:"fileName",label:"File Name",name:"fileName",autoComplete:"fileName",value:d.fileName,disabled:!0,helperText:c.fileName,error:!!c.fileName,InputProps:{endAdornment:e.jsx(x,{variant:"contained",color:"primary",onClick:q,children:"Upload"})}}),e.jsx("input",{type:"file",onChange:K,ref:S,style:{marginTop:20}})]})]}),e.jsxs(ne,{children:[e.jsx(x,{onClick:()=>u(!1),children:"Cancel"}),e.jsx(x,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})]})]})]})};export{we as default};
