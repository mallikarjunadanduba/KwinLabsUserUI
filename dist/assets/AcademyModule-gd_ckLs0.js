import{u as J,r,j as e,M as V,b as D,c as h,G as n,g as _,P as q,I as C,T as I,F as K,h as Q,S as X}from"./index-Dg2GFtxE.js";import{d as Y,D as Z}from"./Add-DhjQQOyT.js";import{h as S}from"./moment-G82_0lEo.js";import{c as $,b as ee}from"./AcademyCategoryApi-ASP_xB5v.js";import{T as te,a as se,b as ae,c as v,d as T,e as re,f as oe}from"./TableRow-tis0D7HP.js";import{E as ie}from"./Edit-CUj485z6.js";import{D as ne}from"./DeleteForever-CR4V1Om4.js";import{D as de,a as le}from"./DialogTitle-CHS1QA2F.js";import{M as ce}from"./MenuItem-DouCongq.js";import"./LastPage-DdfZQxWB.js";const B=[{id:"moduleId",label:"ID"},{id:"moduleName",label:"Name",minWidth:100},{id:"description",label:"Description",minWidth:100},{id:"courseName",label:"Course Name",minWidth:150},{id:"createdBy",label:"Created By",align:"right"},{id:"updatedBy",label:"Updated By",align:"right"},{id:"insertedDate",label:"Inserted Date",align:"right"},{id:"updatedDate",label:"Updated Date",align:"right"},{id:"actions",label:"Actions",align:"right"}],De=()=>{J();const[u,x]=r.useState(0),[d,P]=r.useState(10),[E,M]=r.useState([]),[p,g]=r.useState([]),[w,l]=r.useState(!1),[W,k]=r.useState(!1),[o,f]=r.useState({moduleName:"",description:"",courseId:""}),[i,j]=r.useState({}),[b,A]=r.useState(!1),F=(t,a)=>{x(a)},L=t=>{P(+t.target.value),x(0)},N={"Content-type":"application/json",Authorization:"Bearer "+JSON.parse(sessionStorage.getItem("user")).accessToken},R=async()=>{try{const a=(await $(N)).data.content;if(a){const y=a.map(s=>({moduleId:s.moduleId,moduleName:s.moduleName,description:s.description,courseName:s.academicCourseDtoList&&s.academicCourseDtoList.length>0?s.academicCourseDtoList[0].courseName:"No Course Name",insertedDate:S(s.insertedDate).format("L"),updatedDate:S(s.updatedDate).format("L"),createdBy:s.createdBy?s.createdBy.userName:"No User",updatedBy:s.updatedBy?s.updatedBy.userName:"No User"}));g(y)}else g([])}catch(t){console.error("Error fetching modules:",t)}},U=async()=>{try{const a=(await ee(N)).data.content;if(a){const s=a.sort((c,G)=>c.courseName.localeCompare(G.courseName)).map(c=>({courseId:c.courseId,courseName:c.courseName}));M(s)}}catch(t){console.error("Error fetching courses:",t)}};r.useEffect(()=>{R(),U()},[b]);const H=()=>{const t={};return(!o.moduleName||o.moduleName.trim()==="")&&(t.moduleName="Enter the module name"),(!o.description||o.description.trim()==="")&&(t.description="Enter the description"),o.courseId||(t.courseId="Select a course"),t},m=t=>{f({...o,[t.target.name]:t.target.value}),j({...i,[t.target.name]:null})},z=()=>{k(!1),f({moduleName:"",description:"",courseId:""}),l(!0)},O=()=>{const t=H();Object.keys(t).length===0?(l(!1),A(!b)):j(t)};return e.jsxs(V,{title:e.jsxs(D,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Academy Modules"}),e.jsxs(h,{variant:"contained",color:"primary",sx:{display:"flex",alignItems:"center",fontSize:"15px"},onClick:z,children:["Add",e.jsx(Y,{sx:{color:"#fff"}})]})]}),children:[e.jsx(n,{container:!0,spacing:_}),e.jsxs(q,{sx:{width:"100%",overflow:"hidden"},children:[e.jsx(te,{sx:{maxHeight:440},children:e.jsxs(se,{stickyHeader:!0,"aria-label":"sticky table",children:[e.jsx(ae,{children:e.jsx(v,{children:B.map(t=>e.jsx(T,{align:t.align,style:{minWidth:t.minWidth,fontWeight:600,fontSize:15},children:t.label},t.id))})}),e.jsx(re,{children:p.slice(u*d,u*d+d).map(t=>e.jsx(v,{hover:!0,role:"checkbox",tabIndex:-1,children:B.map(a=>e.jsx(T,{align:a.align,children:a.id==="actions"?e.jsxs(e.Fragment,{children:[e.jsx(C,{color:"primary",children:e.jsx(ie,{})}),e.jsx(C,{color:"error",children:e.jsx(ne,{})})]}):t[a.id]||"No Data"},a.id))},t.moduleId))})]})}),e.jsx(oe,{rowsPerPageOptions:[10,25,100],component:"div",count:p.length,rowsPerPage:d,page:u,onPageChange:F,onRowsPerPageChange:L})]}),e.jsxs(de,{open:w,onClose:()=>l(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(le,{sx:{fontSize:"16px"},children:W?"Edit Module":"Add Module"}),e.jsx(D,{component:"form",noValidate:!0,sx:{p:3},onSubmit:t=>{t.preventDefault(),O()},children:e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(I,{fullWidth:!0,label:"Module Name",name:"moduleName",value:o.moduleName,onChange:m,error:!!i.moduleName,helperText:i.moduleName})}),e.jsx(n,{item:!0,xs:12,children:e.jsx(I,{fullWidth:!0,label:"Description",name:"description",value:o.description,onChange:m,error:!!i.description,helperText:i.description,multiline:!0,rows:3})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(K,{fullWidth:!0,error:!!i.courseId,children:[e.jsx(Q,{children:"Course"}),e.jsx(X,{name:"courseId",value:o.courseId,onChange:m,children:E.map(t=>e.jsx(ce,{value:t.courseId,children:t.courseName},t.courseId))}),i.courseId&&e.jsx(FormHelperText,{children:i.courseId})]})})]})}),e.jsxs(Z,{children:[e.jsx(h,{onClick:()=>l(!1),children:"Cancel"}),e.jsx(h,{type:"submit",variant:"contained",color:"primary",children:"Save"})]})]})]})};export{De as default};
